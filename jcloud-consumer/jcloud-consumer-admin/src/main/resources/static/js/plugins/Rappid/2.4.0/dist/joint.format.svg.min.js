/*! Rappid v2.4.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2019-07-01 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


!function(a,b,c,d){function e(a){var b=c.Deferred(),e=a.attr("xlink:href")||a.attr("href");return d.imageToDataUri(e,function(c,d){!c&&d&&a.attr("xlink:href",d),b.resolve()}),b.promise()}function f(a){return(new XMLSerializer).serializeToString(a).replace(/&nbsp;/g,"Â ")}function g(a,c){var d=a.ownerDocument,e=d.implementation.createDocument(null,"xml",null);b(a).prepend(b("style",{type:"text/css"},[e.createCDATASection(c)]))}function h(b,d){for(var e=Array.from(b.querySelectorAll("*")),f=Array.from(d.querySelectorAll("*")),g=b.ownerDocument,h=g.styleSheets.length,i=[],j=h-1;j>=0;j--)i[j]=g.styleSheets[j],g.styleSheets[j].disabled=!0;var k={};e.forEach(function(b,c){var d=window.getComputedStyle(b,null),e={};a.util.forIn(d,function(a){e[a]=d.getPropertyValue(a)}),k[c]=e}),h!=g.styleSheets.length&&i.forEach(function(a,b){g.styleSheets[b]=a});for(var l=0;l<h;l++)g.styleSheets[l].disabled=!1;var m={};e.forEach(function(b,c){var d=window.getComputedStyle(b,null),e=k[c],f={};a.util.forIn(d,function(a){isNaN(a)&&d.getPropertyValue(a)!==e[a]&&(f[a]=d.getPropertyValue(a))}),m[c]=f}),f.forEach(function(a,b){c(a).css(m[b])})}a.dia.Paper.prototype.toSVG=function(a,i){i=i||{},this.trigger("beforeexport",i);var j=b(this.svg).clone(),k=j.findOne("."+d.addClassNamePrefix("viewport")),l=i.area||this.paperToLocalRect(this.getContentBBox()),m=i.preserveDimensions;m&&j.attr({width:m.width||l.width,height:m.height||l.height}),j.removeAttr("style").attr("viewBox",[l.x,l.y,l.width,l.height].join(" ")),k.removeAttr("transform"),i.useComputedStyles!==!1&&h(this.svg,j.node);var n=i.stylesheet;if(d.isString(n)&&g(j.node,n),this.trigger("afterexport",i),i.convertImagesToDataUris){var o=j.find("image"),p=o.map(e);c.when.apply(c,p).then(function(){a(f(j.node))})}else a(f(j.node))},a.dia.Paper.prototype.openAsSVG=function(a){var b="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",c=d.uniqueId("svg_output");this.toSVG(function(a){var d=window.open("",c,b),e="data:image/svg+xml,"+encodeURIComponent(a);d.document.write('<img src="'+e+'" style="max-height:100%" />')},d.assign({convertImagesToDataUris:!0},a))}}(joint,V,$,joint.util);