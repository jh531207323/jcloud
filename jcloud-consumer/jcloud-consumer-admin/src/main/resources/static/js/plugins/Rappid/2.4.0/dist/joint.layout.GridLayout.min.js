/*! Rappid v2.4.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2019-07-01 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


joint.layout=joint.layout||{},joint.layout.GridLayout={layout:function(a,b){var c;c=a instanceof joint.dia.Graph?a:(new joint.dia.Graph).resetCells(a,{dry:!0,sort:!1}),a=null,b=b||{};var d=c.getElements(),e=b.columns||1,f=Math.ceil(d.length/e),g=b.dx||0,h=b.dy||0,i=void 0===b.centre||b.centre!==!1,j=!!b.resizeToFit,k=b.marginX||0,l=b.marginY||0,m=[],n=b.columnWidth;if("compact"===n)for(var o=0;o<e;o++){var p=this._elementsAtColumn(d,o,e);m.push(this._maxDim(p,"width")+g)}else{n&&!joint.util.isString(n)||(n=this._maxDim(d,"width")+g);for(var q=0;q<e;q++)m.push(n)}var r=this._accumulate(m,k),s=[],t=b.rowHeight;if("compact"===t)for(var u=0;u<f;u++){var v=this._elementsAtRow(d,u,e);s.push(this._maxDim(v,"height")+h)}else{t&&!joint.util.isString(t)||(t=this._maxDim(d,"height")+h);for(var w=0;w<f;w++)s.push(t)}var x=this._accumulate(s,l);c.startBatch("layout"),d.forEach(function(a,c){var d=c%e,f=Math.floor(c/e),k=m[d],l=s[f],n=0,o=0,p=a.get("size");if(j){var q=k-2*g,t=l-2*h,u=p.height*(p.width?q/p.width:1),v=p.width*(p.height?t/p.height:1);u>l?q=v:t=u,p={width:q,height:t},a.set("size",p,b)}i&&(n=(k-p.width)/2,o=(l-p.height)/2),a.position(r[d]+g+n,x[f]+h+o,b)}),c.stopBatch("layout")},_maxDim:function(a,b){return a.reduce(function(a,c){return Math.max(c.get("size")[b],a)},0)},_elementsAtRow:function(a,b,c){for(var d=[],e=c*b,f=e+c;e<f;e++)d.push(a[e]);return d},_elementsAtColumn:function(a,b,c){for(var d=[],e=b,f=a.length;e<f;e+=c)d.push(a[e]);return d},_accumulate:function(a,b){return a.reduce(function(a,b,c){return a.push(a[c]+b),a},[b||0])}};